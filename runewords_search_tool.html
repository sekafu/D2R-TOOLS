<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D2R ãƒ«ãƒ¼ãƒ³ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢ãƒ„ãƒ¼ãƒ«</title>
    <style>
        /* CSSå¤‰æ•°å®šç¾© */
        :root {
            --primary-color: #e94560;
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --accent: #0f4c75;
            --text: #ffffff;
            --text-secondary: #bbbbbb;
            --border: rgba(233, 69, 96, 0.3);
            --success: #4CAF50;
            --warning: #FF9800;
            --danger: #F44336;
            --info: #9E9E9E;
        }

        /* ãƒªã‚»ãƒƒãƒˆ & ãƒ™ãƒ¼ã‚¹ã‚¹ã‚¿ã‚¤ãƒ« */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        .header {
            background: rgba(22, 33, 62, 0.9);
            border-bottom: 2px solid var(--border);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-links a {
            color: var(--text);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: var(--primary-color);
        }

        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        .page-title {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--primary-color);
            font-size: 2rem;
            font-weight: bold;
        }

        /* æ¤œç´¢ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .search-section {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border);
        }

        .search-grid {
            display: grid;
            gap: 1rem;
            grid-template-columns: 1fr;
        }

        @media (min-width: 768px) {
            .search-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .search-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-group label {
            font-weight: bold;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .form-control {
            padding: 0.75rem;
            border: 2px solid var(--border);
            border-radius: 5px;
            background: var(--bg-primary);
            color: var(--text);
            font-size: 1rem;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: #d63851;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--accent);
            color: white;
        }

        .btn-secondary:hover {
            background: #0d3d61;
        }

        /* ãƒ«ãƒ¼ãƒ³ç®¡ç†ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .rune-management {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border);
        }

        .rune-grid {
            display: grid;
            gap: 1rem;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            margin-top: 1rem;
        }

        .rune-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background: var(--bg-primary);
            border-radius: 5px;
            border: 1px solid var(--border);
        }

        .rune-name {
            font-weight: bold;
        }

        .rune-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .rune-count {
            min-width: 30px;
            text-align: center;
            font-weight: bold;
            color: var(--primary-color);
        }

        .btn-small {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
            min-width: 30px;
        }

        /* çµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .results-section {
            margin-top: 2rem;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .results-count {
            color: var(--text-secondary);
        }

        .filter-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            border: 2px solid transparent;
        }

        .filter-btn.active {
            border-color: var(--primary-color);
        }

        /* ãƒ«ãƒ¼ãƒ³ãƒ¯ãƒ¼ãƒ‰ã‚«ãƒ¼ãƒ‰ */
        .runeword-grid {
            display: grid;
            gap: 1.5rem;
            grid-template-columns: 1fr;
        }

        @media (min-width: 768px) {
            .runeword-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1200px) {
            .runeword-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .runeword-card {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 1.5rem;
            border: 2px solid var(--border);
            transition: all 0.3s ease;
        }

        .runeword-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .runeword-card--craftable {
            border-color: var(--success);
        }

        .runeword-card--almost {
            border-color: var(--warning);
        }

        .runeword-card--impossible {
            border-color: var(--danger);
        }

        .runeword-card--partial {
            border-color: var(--info);
        }

        .runeword-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .runeword-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .runeword-english {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        .runeword-level {
            background: var(--accent);
            padding: 0.25rem 0.5rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .runeword-info {
            display: grid;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .info-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .info-value {
            font-weight: bold;
        }

        .runes-required {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }

        .rune-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            border: 1px solid;
        }

        .rune-badge--owned {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .rune-badge--missing {
            background: var(--danger);
            border-color: var(--danger);
            color: white;
        }

        .status-message {
            padding: 0.75rem;
            border-radius: 5px;
            font-size: 0.9rem;
            font-weight: bold;
            text-align: center;
            margin-top: 1rem;
        }

        .status-message--craftable {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid var(--success);
            color: var(--success);
        }

        .status-message--almost {
            background: rgba(255, 152, 0, 0.2);
            border: 1px solid var(--warning);
            color: var(--warning);
        }

        .status-message--impossible {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid var(--danger);
            color: var(--danger);
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            .nav-links {
                gap: 1rem;
            }

            .page-title {
                font-size: 1.5rem;
            }

            .search-section, .rune-management {
                padding: 1rem;
            }

            .filter-buttons {
                justify-content: center;
            }
        }

        /* ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¯ãƒ©ã‚¹ */
        .text-center { text-align: center; }
        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo">D2Ræ”»ç•¥ãƒ„ãƒ¼ãƒ«</a>
            <nav>
                <ul class="nav-links">
                    <li><a href="#">ğŸ  ãƒ›ãƒ¼ãƒ </a></li>
                    <li><a href="#">ğŸ”® ãƒ«ãƒ¼ãƒ³ãƒ¯ãƒ¼ãƒ‰</a></li>
                    <li><a href="#">ğŸ’ ãƒ«ãƒ¼ãƒ³</a></li>
                    <li><a href="#">âš”ï¸ ã‚¢ã‚¤ãƒ†ãƒ </a></li>
                    <li><a href="#">ğŸ§® è¨ˆç®—æ©Ÿ</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main class="container">
        <h1 class="page-title">ğŸ”® ãƒ«ãƒ¼ãƒ³ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢ãƒ»ç®¡ç†ãƒ„ãƒ¼ãƒ«</h1>

        <!-- æ¤œç´¢ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="search-section">
            <h2 class="mb-2">ğŸ” æ¤œç´¢ãƒ»çµã‚Šè¾¼ã¿</h2>
            <div class="search-grid">
                <div class="form-group">
                    <label for="searchName">ãƒ«ãƒ¼ãƒ³ãƒ¯ãƒ¼ãƒ‰å</label>
                    <input type="text" id="searchName" class="form-control" placeholder="ç²¾éœŠã€Spirit ãªã©">
                </div>
                <div class="form-group">
                    <label for="searchRune">å«ã‚€ãƒ«ãƒ¼ãƒ³</label>
                    <select id="searchRune" class="form-control">
                        <option value="">ã™ã¹ã¦</option>
                        <option value="ã‚¨ãƒ«">ã‚¨ãƒ« (El)</option>
                        <option value="ã‚¨ãƒ«ãƒ‰">ã‚¨ãƒ«ãƒ‰ (Eld)</option>
                        <option value="ãƒ†ã‚£ã‚¢">ãƒ†ã‚£ã‚¢ (Tir)</option>
                        <option value="ãƒãƒ•">ãƒãƒ• (Nef)</option>
                        <option value="ã‚¨ã‚¹">ã‚¨ã‚¹ (Eth)</option>
                        <option value="ã‚¤ã‚¹">ã‚¤ã‚¹ (Ith)</option>
                        <option value="ã‚¿ãƒ«">ã‚¿ãƒ« (Tal)</option>
                        <option value="ãƒ©ãƒ«">ãƒ©ãƒ« (Ral)</option>
                        <option value="ã‚ªãƒ«ãƒˆ">ã‚ªãƒ«ãƒˆ (Ort)</option>
                        <option value="ã‚¹ãƒ«">ã‚¹ãƒ« (Thul)</option>
                        <option value="ã‚¢ãƒ ãƒ³">ã‚¢ãƒ ãƒ³ (Amn)</option>
                        <option value="ã‚½ãƒ«">ã‚½ãƒ« (Sol)</option>
                        <option value="ã‚·ãƒ£ã‚¨ãƒ«">ã‚·ãƒ£ã‚¨ãƒ« (Shael)</option>
                        <option value="ãƒ‰ãƒ«">ãƒ‰ãƒ« (Dol)</option>
                        <option value="ãƒ˜ãƒ«">ãƒ˜ãƒ« (Hel)</option>
                        <option value="ã‚¤ã‚ª">ã‚¤ã‚ª (Io)</option>
                        <option value="ãƒ©ãƒ ">ãƒ©ãƒ  (Lum)</option>
                        <option value="ã‚³ãƒ¼">ã‚³ãƒ¼ (Ko)</option>
                        <option value="ãƒ•ã‚¡ãƒ«">ãƒ•ã‚¡ãƒ« (Fal)</option>
                        <option value="ãƒ¬ãƒ ">ãƒ¬ãƒ  (Lem)</option>
                        <option value="ãƒ—ãƒ¼ãƒ«">ãƒ—ãƒ¼ãƒ« (Pul)</option>
                        <option value="ã‚¦ãƒ ">ã‚¦ãƒ  (Um)</option>
                        <option value="ãƒãƒ«">ãƒãƒ« (Mal)</option>
                        <option value="ã‚¤ã‚¹ãƒˆ">ã‚¤ã‚¹ãƒˆ (Ist)</option>
                        <option value="ã‚°ãƒ«">ã‚°ãƒ« (Gul)</option>
                        <option value="ãƒ´ã‚§ãƒƒã‚¯ã‚¹">ãƒ´ã‚§ãƒƒã‚¯ã‚¹ (Vex)</option>
                        <option value="ã‚ªãƒ¼ãƒ ">ã‚ªãƒ¼ãƒ  (Ohm)</option>
                        <option value="ãƒ­ãƒ¼">ãƒ­ãƒ¼ (Lo)</option>
                        <option value="ã‚µãƒ¼">ã‚µãƒ¼ (Sur)</option>
                        <option value="ãƒ™ãƒ«">ãƒ™ãƒ« (Ber)</option>
                        <option value="ã‚¸ãƒ£ãƒ¼">ã‚¸ãƒ£ãƒ¼ (Jah)</option>
                        <option value="ãƒãƒ£ãƒ ">ãƒãƒ£ãƒ  (Cham)</option>
                        <option value="ã‚¾ãƒƒãƒ‰">ã‚¾ãƒƒãƒ‰ (Zod)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="searchEquipment">è£…å‚™ã‚¿ã‚¤ãƒ—</label>
                    <select id="searchEquipment" class="form-control">
                        <option value="">ã™ã¹ã¦</option>
                        <option value="æ­¦å™¨">æ­¦å™¨</option>
                        <option value="é§">é§</option>
                        <option value="ç›¾">ç›¾</option>
                        <option value="å…œ">å…œ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="searchSockets">ã‚½ã‚±ãƒƒãƒˆæ•°</label>
                    <select id="searchSockets" class="form-control">
                        <option value="">ã™ã¹ã¦</option>
                        <option value="2">2ã‚½ã‚±ãƒƒãƒˆ</option>
                        <option value="3">3ã‚½ã‚±ãƒƒãƒˆ</option>
                        <option value="4">4ã‚½ã‚±ãƒƒãƒˆ</option>
                        <option value="5">5ã‚½ã‚±ãƒƒãƒˆ</option>
                        <option value="6">6ã‚½ã‚±ãƒƒãƒˆ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="searchMinLevel">æœ€å°ãƒ¬ãƒ™ãƒ«</label>
                    <input type="number" id="searchMinLevel" class="form-control" placeholder="1" min="1" max="99">
                </div>
                <div class="form-group">
                    <label for="searchMaxLevel">æœ€å¤§ãƒ¬ãƒ™ãƒ«</label>
                    <input type="number" id="searchMaxLevel" class="form-control" placeholder="99" min="1" max="99">
                </div>
            </div>
            <div class="text-center mt-2">
                <button class="btn btn-primary" onclick="searchRunewords()">ğŸ” æ¤œç´¢</button>
                <button class="btn btn-secondary" onclick="resetSearch()">ğŸ”„ ãƒªã‚»ãƒƒãƒˆ</button>
            </div>
        </section>

        <!-- ãƒ«ãƒ¼ãƒ³ç®¡ç†ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="rune-management">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h2>ğŸ’ ãƒ«ãƒ¼ãƒ³åœ¨åº«ç®¡ç†</h2>
                <div>
                    <button class="btn btn-secondary btn-small" onclick="resetRunes()">ãƒªã‚»ãƒƒãƒˆ</button>
                    <button class="btn btn-secondary btn-small" onclick="exportRunes()">ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
                    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importRunes(event)">
                    <button class="btn btn-secondary btn-small" onclick="document.getElementById('importFile').click()">ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</button>
                </div>
            </div>
            <div class="rune-grid" id="runeGrid"></div>
        </section>

        <!-- çµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="results-section">
            <div class="results-header">
                <h2>ğŸ“‹ æ¤œç´¢çµæœ</h2>
                <div class="filter-buttons">
                    <button class="btn filter-btn btn-secondary active" data-filter="all" onclick="setFilter('all')">ã™ã¹ã¦</button>
                    <button class="btn filter-btn btn-secondary" data-filter="craftable" onclick="setFilter('craftable')">ğŸŸ¢ ä½œæˆå¯èƒ½</button>
                    <button class="btn filter-btn btn-secondary" data-filter="almost" onclick="setFilter('almost')">ğŸŸ¡ ã‚ã¨å°‘ã—</button>
                    <button class="btn filter-btn btn-secondary" data-filter="impossible" onclick="setFilter('impossible')">ğŸ”´ ä½œæˆä¸å¯</button>
                </div>
            </div>
            <div class="results-count" id="resultsCount">0ä»¶ã®ãƒ«ãƒ¼ãƒ³ãƒ¯ãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ</div>
            <div class="runeword-grid" id="runewordResults"></div>
        </section>
    </main>

    <script>
        // ã‚µãƒ³ãƒ—ãƒ«ãƒ«ãƒ¼ãƒ³ãƒ¯ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿
        const RUNEWORDS = [
            {
                id: 'spirit',
                name: 'ç²¾éœŠ',
                english: 'Spirit',
                level: 25,
                sockets: 4,
                equipment: ['å‰£', 'ç›¾'],
                runes: ['ã‚¿ãƒ«', 'ã‚¹ãƒ«', 'ã‚ªãƒ«ãƒˆ', 'ã‚¢ãƒ ãƒ³'],
                effects: [
                    'å…¨ã‚¹ã‚­ãƒ«ãƒ¬ãƒ™ãƒ«+2',
                    'ã‚¹ã‚­ãƒ«ç™ºå‹•é€Ÿåº¦ï¼ˆFCRï¼‰+25~35%',
                    'ãƒ’ãƒƒãƒˆãƒªã‚«ãƒãƒªãƒ¼é€Ÿåº¦ï¼ˆFHRï¼‰+55%',
                    'ãƒãƒŠ+89~112',
                    'å†·æ°—ãƒ€ãƒ¡ãƒ¼ã‚¸+3~8',
                    'ãƒ©ã‚¤ãƒˆãƒ‹ãƒ³ã‚°ãƒ»ãƒœãƒ«ãƒˆï¼ˆãƒ¬ãƒ™ãƒ«1ã€60å›ä½¿ç”¨å¯èƒ½ï¼‰',
                    'ç”Ÿå‘½åŠ›+22',
                    'é­”æ³•ã‚¢ã‚¤ãƒ†ãƒ ç™ºè¦‹ç¢ºç‡+10~20%'
                ],
                version: 'Ver. 1.10'
            },
            {
                id: 'insight',
                name: 'æ´å¯Ÿ',
                english: 'Insight',
                level: 27,
                sockets: 4,
                equipment: ['ãƒãƒ¼ãƒ«ã‚¢ãƒ¼ãƒ ', 'æ–'],
                runes: ['ãƒ©ãƒ«', 'ãƒ†ã‚£ã‚¢', 'ã‚¿ãƒ«', 'ã‚½ãƒ«'],
                effects: [
                    'ãƒ¬ãƒ™ãƒ«12~17 ãƒ¡ãƒ‡ã‚£ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ã‚ªãƒ¼ãƒ©',
                    'ã‚¹ã‚­ãƒ«ç™ºå‹•é€Ÿåº¦ï¼ˆFCRï¼‰+35%',
                    'ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãƒ»ã‚¹ãƒˆãƒ©ã‚¤ã‚¯+200~260%',
                    'æ”»æ’ƒé€Ÿåº¦ï¼ˆIASï¼‰+23%',
                    'å…¨è€æ€§+5~25',
                    'æ•µã®ç‰©ç†ãƒ€ãƒ¡ãƒ¼ã‚¸è»½æ¸›-7',
                    'ãƒãƒŠå¢—åŠ +8~16'
                ],
                version: 'Ver. 1.10'
            },
            {
                id: 'enigma',
                name: 'è¬',
                english: 'Enigma',
                level: 65,
                sockets: 3,
                equipment: ['é§'],
                runes: ['ã‚¸ãƒ£ãƒ¼', 'ã‚¤ã‚¹', 'ãƒ™ãƒ«'],
                effects: [
                    'ãƒ†ãƒ¬ãƒãƒ¼ãƒˆï¼ˆãƒ¬ãƒ™ãƒ«1ã€ç„¡åˆ¶é™ä½¿ç”¨å¯èƒ½ï¼‰',
                    'å…¨ã‚¹ã‚­ãƒ«ãƒ¬ãƒ™ãƒ«+2',
                    'ç­‹åŠ›+0.75Ã—ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ¬ãƒ™ãƒ«',
                    'ãƒ©ã‚¤ãƒ•+500~750',
                    'ãƒãƒŠ+500~750',
                    'å…¨è€æ€§+5',
                    'ãƒ€ãƒ¡ãƒ¼ã‚¸è»½æ¸›ï¼ˆï¼…ï¼‰+8',
                    'é­”æ³•ãƒ€ãƒ¡ãƒ¼ã‚¸è»½æ¸›+14',
                    'é­”æ³•ã‚¢ã‚¤ãƒ†ãƒ ç™ºè¦‹ç¢ºç‡+50~100%'
                ],
                version: 'Ver. 1.10'
            },
            {
                id: 'stealth',
                name: 'éš å¯†',
                english: 'Stealth',
                level: 17,
                sockets: 2,
                equipment: ['é§'],
                runes: ['ã‚¿ãƒ«', 'ã‚¨ã‚¹'],
                effects: [
                    'é­”æ³•ãƒ€ãƒ¡ãƒ¼ã‚¸è»½æ¸›+3',
                    'ç§»å‹•é€Ÿåº¦+25%',
                    'æ”»æ’ƒé€Ÿåº¦ï¼ˆIASï¼‰+25%',
                    'ã‚¹ã‚­ãƒ«ç™ºå‹•é€Ÿåº¦ï¼ˆFCRï¼‰+25%',
                    'ãƒ’ãƒƒãƒˆãƒªã‚«ãƒãƒªãƒ¼é€Ÿåº¦ï¼ˆFHRï¼‰+25%',
                    'æ¯’æŠµæŠ—+30%',
                    'å†ç”Ÿèƒ½åŠ›+10'
                ],
                version: 'Ver. 1.09'
            },
            {
                id: 'leaf',
                name: 'è‘‰',
                english: 'Leaf',
                level: 19,
                sockets: 2,
                equipment: ['æ–'],
                runes: ['ãƒ†ã‚£ã‚¢', 'ãƒ©ãƒ«'],
                effects: [
                    'ç«ç‚ã‚¹ã‚­ãƒ«+3ï¼ˆã‚½ãƒ¼ã‚µãƒ¬ã‚¹å°‚ç”¨ï¼‰',
                    'ãƒ•ã‚¡ã‚¤ã‚¢ãƒ»ãƒœãƒ«ãƒˆï¼ˆãƒ¬ãƒ™ãƒ«14ã€60å›ä½¿ç”¨å¯èƒ½ï¼‰',
                    'ãƒ•ã‚¡ã‚¤ã‚¢ãƒ¼ãƒœãƒ¼ãƒ«ï¼ˆãƒ¬ãƒ™ãƒ«18ã€60å›ä½¿ç”¨å¯èƒ½ï¼‰',
                    'ãƒ•ã‚¡ã‚¤ã‚¢ãƒ»ãƒœãƒ«ãƒˆ+3',
                    'ã‚¤ãƒ³ãƒ•ã‚§ãƒ«ãƒ+3',
                    'ã‚¦ã‚©ãƒ¼ãƒ ã‚¹+3',
                    'ç«ç‚æŠµæŠ—+33%',
                    'å†·æ°—æŠµæŠ—+2',
                    'é˜²å¾¡åŠ›+2~6'
                ],
                version: 'Ver. 1.09'
            }
        ];

        // ãƒ«ãƒ¼ãƒ³ä¸€è¦§
        const RUNES = [
            'ã‚¨ãƒ«', 'ã‚¨ãƒ«ãƒ‰', 'ãƒ†ã‚£ã‚¢', 'ãƒãƒ•', 'ã‚¨ã‚¹', 'ã‚¤ã‚¹', 'ã‚¿ãƒ«', 'ãƒ©ãƒ«',
            'ã‚ªãƒ«ãƒˆ', 'ã‚¹ãƒ«', 'ã‚¢ãƒ ãƒ³', 'ã‚½ãƒ«', 'ã‚·ãƒ£ã‚¨ãƒ«', 'ãƒ‰ãƒ«', 'ãƒ˜ãƒ«', 'ã‚¤ã‚ª',
            'ãƒ©ãƒ ', 'ã‚³ãƒ¼', 'ãƒ•ã‚¡ãƒ«', 'ãƒ¬ãƒ ', 'ãƒ—ãƒ¼ãƒ«', 'ã‚¦ãƒ ', 'ãƒãƒ«', 'ã‚¤ã‚¹ãƒˆ',
            'ã‚°ãƒ«', 'ãƒ´ã‚§ãƒƒã‚¯ã‚¹', 'ã‚ªãƒ¼ãƒ ', 'ãƒ­ãƒ¼', 'ã‚µãƒ¼', 'ãƒ™ãƒ«', 'ã‚¸ãƒ£ãƒ¼', 'ãƒãƒ£ãƒ ', 'ã‚¾ãƒƒãƒ‰'
        ];

        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let playerRunes = {};
        let currentFilter = 'all';
        let filteredResults = [];

        // åˆæœŸåŒ–
        function init() {
            loadPlayerRunes();
            renderRuneGrid();
            searchRunewords();
        }

        // LocalStorageã‹ã‚‰ãƒ«ãƒ¼ãƒ³æ‰€æŒæ•°ã‚’èª­ã¿è¾¼ã¿
        function loadPlayerRunes() {
            const saved = localStorage.getItem('d2r-player-runes');
            if (saved) {
                playerRunes = JSON.parse(saved);
            } else {
                // åˆæœŸåŒ–ï¼šã™ã¹ã¦ã®ãƒ«ãƒ¼ãƒ³ã‚’0å€‹ã«è¨­å®š
                RUNES.forEach(rune => {
                    playerRunes[rune] = 0;
                });
            }
        }

        // ãƒ«ãƒ¼ãƒ³æ‰€æŒæ•°ã‚’LocalStorageã«ä¿å­˜
        function savePlayerRunes() {
            localStorage.setItem('d2r-player-runes', JSON.stringify(playerRunes));
        }

        // ãƒ«ãƒ¼ãƒ³ã‚°ãƒªãƒƒãƒ‰ã‚’è¡¨ç¤º
        function renderRuneGrid() {
            const grid = document.getElementById('runeGrid');
            grid.innerHTML = '';

            RUNES.forEach(rune => {
                const runeItem = document.createElement('div');
                runeItem.className = 'rune-item';
                runeItem.innerHTML = `
                    <span class="rune-name">${rune}</span>
                    <div class="rune-controls">
                        <button class="btn btn-danger btn-small" onclick="changeRuneCount('${rune}', -1)">-</button>
                        <span class="rune-count">${playerRunes[rune] || 0}</span>
                        <button class="btn btn-primary btn-small" onclick="changeRuneCount('${rune}', 1)">+</button>
                    </div>
                `;
                grid.appendChild(runeItem);
            });
        }

        // ãƒ«ãƒ¼ãƒ³å€‹æ•°ã‚’å¤‰æ›´
        function changeRuneCount(runeName, delta) {
            const currentCount = playerRunes[runeName] || 0;
            const newCount = Math.max(0, currentCount + delta);
            playerRunes[runeName] = newCount;
            savePlayerRunes();
            renderRuneGrid();
            searchRunewords(); // çµæœã‚’æ›´æ–°
        }

        // ãƒ«ãƒ¼ãƒ³æ‰€æŒæ•°ã‚’ãƒªã‚»ãƒƒãƒˆ
        function resetRunes() {
            if (confirm('ã™ã¹ã¦ã®ãƒ«ãƒ¼ãƒ³æ‰€æŒæ•°ã‚’0ã«ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ')) {
                RUNES.forEach(rune => {
                    playerRunes[rune] = 0;
                });
                savePlayerRunes();
                renderRuneGrid();
                searchRunewords();
            }
        }

        // ãƒ«ãƒ¼ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
        function exportRunes() {
            const data = {
                playerRunes: playerRunes,
                exportDate: new Date().toISOString()
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'd2r-runes-backup.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        // ãƒ«ãƒ¼ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
        function importRunes(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.playerRunes) {
                        playerRunes = data.playerRunes;
                        savePlayerRunes();
                        renderRuneGrid();
                        searchRunewords();
                        alert('ãƒ«ãƒ¼ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ');
                    } else {
                        alert('ç„¡åŠ¹ãªãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã§ã™');
                    }
                } catch (error) {
                    alert('ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
                }
            };
            reader.readAsText(file);
        }

        // ãƒ«ãƒ¼ãƒ³ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢
        function searchRunewords() {
            const name = document.getElementById('searchName').value.toLowerCase();
            const rune = document.getElementById('searchRune').value;
            const equipment = document.getElementById('searchEquipment').value;
            const sockets = document.getElementById('searchSockets').value;
            const minLevel = parseInt(document.getElementById('searchMinLevel').value) || 0;
            const maxLevel = parseInt(document.getElementById('searchMaxLevel').value) || 99;

            filteredResults = RUNEWORDS.filter(rw => {
                // åå‰æ¤œç´¢
                if (name && !rw.name.toLowerCase().includes(name) && !rw.english.toLowerCase().includes(name)) {
                    return false;
                }

                // ãƒ«ãƒ¼ãƒ³æ¤œç´¢
                if (rune && !rw.runes.includes(rune)) {
                    return false;
                }

                // è£…å‚™ã‚¿ã‚¤ãƒ—
                if (equipment && !rw.equipment.some(eq => eq.includes(equipment))) {
                    return false;
                }

                // ã‚½ã‚±ãƒƒãƒˆæ•°
                if (sockets && rw.sockets !== parseInt(sockets)) {
                    return false;
                }

                // ãƒ¬ãƒ™ãƒ«ç¯„å›²
                if (rw.level < minLevel || rw.level > maxLevel) {
                    return false;
                }

                return true;
            });

            renderResults();
        }

        // æ¤œç´¢ã‚’ãƒªã‚»ãƒƒãƒˆ
        function resetSearch() {
            document.getElementById('searchName').value = '';
            document.getElementById('searchRune').value = '';
            document.getElementById('searchEquipment').value = '';
            document.getElementById('searchSockets').value = '';
            document.getElementById('searchMinLevel').value = '';
            document.getElementById('searchMaxLevel').value = '';
            searchRunewords();
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’è¨­å®š
        function setFilter(filter) {
            currentFilter = filter;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.filter === filter);
            });
            renderResults();
        }

        // ä½œæˆå¯èƒ½æ€§ã‚’åˆ¤å®š
        function getCraftabilityStatus(runeword) {
            const missing = [];
            let totalMissing = 0;

            for (const requiredRune of runeword.runes) {
                const owned = playerRunes[requiredRune] || 0;
                if (owned === 0) {
                    missing.push(requiredRune);
                    totalMissing++;
                }
            }

            if (totalMissing === 0) return 'craftable';
            if (totalMissing <= 2) return 'almost';
            if (missing.length === runeword.runes.length) return 'impossible';
            return 'partial';
        }

        // çµæœã‚’è¡¨ç¤º
        function renderResults() {
            const container = document.getElementById('runewordResults');
            const countElement = document.getElementById('resultsCount');

            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
            let displayResults = filteredResults;
            if (currentFilter !== 'all') {
                displayResults = filteredResults.filter(rw => {
                    const status = getCraftabilityStatus(rw);
                    return status === currentFilter;
                });
            }

            countElement.textContent = `${displayResults.length}ä»¶ã®ãƒ«ãƒ¼ãƒ³ãƒ¯ãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ`;
            container.innerHTML = '';

            displayResults.forEach(runeword => {
                const status = getCraftabilityStatus(runeword);
                const card = document.createElement('div');
                card.className = `runeword-card runeword-card--${status}`;

                const statusMessages = {
                    craftable: 'âœ… ä½œæˆå¯èƒ½ï¼',
                    almost: 'âš ï¸ ã‚ã¨å°‘ã—ã§ä½œæˆå¯èƒ½',
                    impossible: 'âŒ ä½œæˆä¸å¯èƒ½',
                    partial: 'ğŸ”¶ ä¸€éƒ¨ãƒ«ãƒ¼ãƒ³æ‰€æŒ'
                };

                const statusClasses = {
                    craftable: 'status-message--craftable',
                    almost: 'status-message--almost',
                    impossible: 'status-message--impossible',
                    partial: 'status-message--almost'
                };

                card.innerHTML = `
                    <div class="runeword-header">
                        <div>
                            <div class="runeword-name">${runeword.name}</div>
                            <div class="runeword-english">${runeword.english}</div>
                        </div>
                        <div class="runeword-level">Lv.${runeword.level}</div>
                    </div>
                    <div class="runeword-info">
                        <div class="info-row">
                            <span class="info-label">è£…å‚™ã‚¿ã‚¤ãƒ—</span>
                            <span class="info-value">${runeword.equipment.join(', ')}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">ã‚½ã‚±ãƒƒãƒˆæ•°</span>
                            <span class="info-value">${runeword.sockets}</span>
                        </div>
                    </div>
                    <div class="runes-required">
                        ${runeword.runes.map(rune => {
                            const owned = playerRunes[rune] || 0;
                            const hasRune = owned > 0;
                            return `<span class="rune-badge ${hasRune ? 'rune-badge--owned' : 'rune-badge--missing'}">
                                ${rune} ${hasRune ? 'âœ…' : 'âŒ'}
                            </span>`;
                        }).join('')}
                    </div>
                    <div class="status-message ${statusClasses[status]}">
                        ${statusMessages[status]}
                    </div>
                `;

                container.appendChild(card);
            });
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', init);

        // æ¤œç´¢ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§ã®Enterã‚­ãƒ¼å¯¾å¿œ
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchRunewords();
            }
        });
    </script>
</body>
</html>